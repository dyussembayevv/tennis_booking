{% extends 'tennis/base.html' %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç{% endblock %}

{% block content %}
<div class="page-title">
    <h1>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
    <p style="color: #7f8c8d; margin-top: 1rem;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.get_full_name|default:user.username }}!</p>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
    </div>
    <div class="btn-group">
        <a href="{% url 'booking_step1' %}" class="btn btn-primary">
            üéæ –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        </a>
        <a href="{% url 'home' %}" class="btn btn-secondary">
            üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é
        </a>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">–ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
        <p style="color: #7f8c8d;">–ò—Å—Ç–æ—Ä–∏—è –∏ —Ç–µ–∫—É—â–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</p>
    </div>

    {% if bookings %}
        <div class="grid grid-1">
            {% for booking in bookings %}
                <div class="card" style="margin: 0; border-left: 4px solid 
                    {% if booking.status == 'pending' %}#f39c12
                    {% elif booking.status == 'paid' %}#27ae60
                    {% else %}#e74c3c{% endif %};">
                    
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div>
                            <h4 style="color: #2c3e50; margin-bottom: 0.5rem;">
                                {{ booking.tennis_center.name }}
                            </h4>
                            <p style="color: #7f8c8d; margin-bottom: 0.3rem;">
                                <strong>–ö–æ—Ä—Ç:</strong> {{ booking.court }}
                            </p>
                            <p style="color: #7f8c8d; margin-bottom: 0.3rem;">
                                <strong>–î–∞—Ç–∞:</strong> {{ booking.date|date:"d.m.Y" }} –≤ {{ booking.start_time|time:"H:i" }}
                            </p>
                            <p style="color: #7f8c8d; margin-bottom: 0.3rem;">
                                <strong>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> {{ booking.duration_hours }} —á–∞—Å{{ booking.duration_hours|pluralize:"–∞,–æ–≤" }}
                            </p>
                        </div>
                        <div style="text-align: right;">
                            <span style="background: 
                                {% if booking.status == 'pending' %}#f39c12
                                {% elif booking.status == 'paid' %}#27ae60
                                {% else %}#e74c3c{% endif %};
                                color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.9rem;">
                                {{ booking.get_status_display }}
                            </span>
                            <p style="font-size: 1.2rem; font-weight: bold; color: #2c3e50; margin-top: 0.5rem;">
                                {{ booking.total_price }}‚Ç∏
                            </p>
                        </div>
                    </div>

                    {% if booking.trainer_service or booking.racket_rental or booking.balls_rental %}
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 5px; margin-bottom: 1rem;">
                            <strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:</strong>
                            {% if booking.trainer_service %}<span style="margin-left: 0.5rem; color: #27ae60;">–¢—Ä–µ–Ω–µ—Ä</span>{% endif %}
                            {% if booking.racket_rental %}<span style="margin-left: 0.5rem; color: #27ae60;">–†–∞–∫–µ—Ç–∫–∏ ({{ booking.racket_rental }})</span>{% endif %}
                            {% if booking.balls_rental %}<span style="margin-left: 0.5rem; color: #27ae60;">–ú—è—á–∏</span>{% endif %}
                        </div>
                    {% endif %}

                    <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid #ecf0f1;">
                        <small style="color: #7f8c8d;">
                            –°–æ–∑–¥–∞–Ω–æ: {{ booking.created_at|date:"d.m.Y H:i" }}
                        </small>
                        {% if booking.can_be_cancelled %}
                            <a href="{% url 'cancel_booking' booking.id %}" 
                               class="btn btn-danger" 
                               style="padding: 0.3rem 0.8rem; font-size: 0.9rem;"
                               onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å —ç—Ç–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?')">
                                –û—Ç–º–µ–Ω–∏—Ç—å
                            </a>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 3rem; color: #7f8c8d;">
            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</h3>
            <p style="margin: 1rem 0;">–ù–∞—á–Ω–∏—Ç–µ —Å —Å–æ–∑–¥–∞–Ω–∏—è –≤–∞—à–µ–≥–æ –ø–µ—Ä–≤–æ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è!</p>
            <a href="{% url 'booking_step1' %}" class="btn btn-primary">
                üéæ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ç
            </a>
        </div>
    {% endif %}
</div>
{% endblock %}